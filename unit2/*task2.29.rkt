#lang racket
;ä»¥ä¸‹æ˜¯æŒ‰ç…§é—®é¢˜ d çš„è¡¨ç¤ºæ–¹å¼å†™çš„
;å¦‚æœæŠŠmake-mobileå’Œmake-branchä¸ç”¨consç”¨listçš„è¯ ç¨‹åºéœ€è¦ä¿®æ”¹çš„åªæœ‰åœ¨letçš„æ—¶å€™ä¿®æ”¹ä¸€ä¸‹å°±å¯ä»¥äº†
(define (make-mobile left right)
  (cons left right))
(define (make-branch length structure)
  (cons length structure))
(define (left-branch mobile)
  (car mobile))
(define (right-branch mobile)
  (cdr mobile))
(define (branch-length branch)
  (car branch))
(define (branch-structure branch)
  (cdr branch))
(define (total-weight mobile)
  (define (iter items weight)
    (let ((node-right (branch-structure (right-branch items)))
          (node-left (branch-structure (left-branch items))))
      (cond ((and (pair? node-left) (pair? node-right)) (+ weight (iter node-left 0) (iter node-right 0)))
            ((and (pair? node-left) (not (pair? node-right))) (+ weight (iter node-left 0) node-right))
            ((and (pair? node-right) (not (pair? node-left))) (+ weight (iter node-right 0) node-left))
            (else (+ weight node-left node-right)))))
  (iter mobile 0))
;ä¸€ä¸ªğŸŒ°
(define mobile (make-mobile (make-branch 10 25)
                            (make-branch 5 20)))
;ä¸¤ä¸ªğŸŒ°
(define lsl (make-mobile (make-branch 10 mobile)
                         (make-branch 10 mobile)))
(total-weight lsl)
;åˆ¤æ–­æ˜¯å¦å¹³è¡¡

(define (balance? mobile)
  (define (iter items weight)
    (let ((node-right (branch-structure (right-branch items)))
          (node-left (branch-structure (left-branch items))))
      (cond ((and (pair? node-left) (pair? node-right)) (+ weight (iter node-left 0) (iter node-right 0)))
            ((and (pair? node-left) (not (pair? node-right))) (+ weight (iter node-left 0) node-right))
            ((and (pair? node-right) (not (pair? node-left))) (+ weight (iter node-right 0) node-left))
            (else (+ weight node-left node-right)))))
(iter mobile 0))
